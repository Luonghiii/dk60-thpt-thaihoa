<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Đây là nơi lưu giữ kỉ niệm của DK60 ❤</title>
  <link id="dynamic-favicon" rel="icon" type="image/png" href="images/logo/logo1.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden; /* Prevents scrollbars on the body itself */
      font-family: 'Inter', sans-serif;
    }

    #content-frame {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
      z-index: 0; /* Main content iframe is behind popups */
    }

    .popup {
      position: fixed; /* Fixed position relative to the viewport */
      bottom: 80px;  /* Position above the music buttons */
      left: 20px;
      width: 350px;  /* Fixed width for the popup */
      max-height: calc(100vh - 100px); /* Max height to not overflow viewport */
      z-index: 1000; /* High z-index to be on top */
      transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
      opacity: 0;
      transform: translateY(20px) scale(0.95); /* Start slightly down and scaled down */
      pointer-events: none; /* Not interactive when hidden */
      border-radius: 0.75rem; /* Tailwind's rounded-xl */
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Tailwind's shadow-xl */
      overflow: hidden; /* Ensures content respects border radius */
      display: flex;
      flex-direction: column;
    }

    .popup.active {
      opacity: 1;
      transform: translateY(0) scale(1); /* Animate to full size and correct position */
      pointer-events: auto; /* Interactive when active */
    }
    
    .popup-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem 1rem; /* p-3 */
        background-color: #f3f4f6; /* bg-gray-100 */
        border-bottom: 1px solid #e5e7eb; /* border-gray-200 */
    }

    .popup-header .title {
        font-weight: 600; /* font-semibold */
    }
    
    .popup-header .close-popup-btn {
        background: none;
        border: none;
        font-size: 1.5rem; /* text-2xl */
        line-height: 1;
        color: #6b7280; /* text-gray-500 */
        cursor: pointer;
        padding: 0.25rem; /* p-1 */
    }
    .popup-header .close-popup-btn:hover {
        color: #111827; /* text-gray-900 */
    }

    .popup-content {
        flex-grow: 1; /* Allows iframe to fill available space */
        overflow: hidden; /* Important for iframe to not break layout */
    }
    .popup-content iframe {
        width: 100%;
        height: 100%;
        border: none;
    }


.music-buttons-container {
      position: fixed;
      bottom: 1rem; /* bottom-4 */
      left: 1rem;   /* left-4 */
      top: 1rem;    /* Thay bottom thành top */
      left: 1rem;
      display: flex;
      gap: 0.75rem; /* gap-3 */
      z-index: 999; /* Below popups but above main content */
}

    .circle-btn {
      width: 48px;  /* Consistent size */
      height: 48px; /* Consistent size */
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 9999px; /* rounded-full */
      color: white;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
      transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
    }
    .circle-btn:hover {
        transform: scale(1.05); /* Slight scale on hover */
    }

    .soundcloud-attribution {
      font-size: 0.625rem; /* text-xs */
      color: #4b5563; /* text-gray-600 */
      padding: 0.5rem; /* p-2 */
      background-color: #f9fafb; /* bg-gray-50 */
      border-top: 1px solid #e5e7eb; /* border-gray-200 */
      text-align: center;
    }

    .soundcloud-attribution a {
      color: #3b82f6; /* text-blue-500 */
      text-decoration: none;
    }
    .soundcloud-attribution a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

<iframe id="content-frame" src="index.html" title="Nội dung chính"></iframe>

<iframe src="about.html" style="display: none;" title="Trang Giới Thiệu (ẩn)"></iframe>
<iframe src="contact.html" style="display: none;" title="Trang Liên Hệ (ẩn)"></iframe>
<iframe src="thanh-vien-lop.html" style="display: none;" title="Trang Thành Viên (ẩn)"></iframe>
<div class="music-buttons-container">
  <button id="btnSpotify" aria-label="Mở trình phát Spotify" class="circle-btn bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75">
    <svg role="img" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true">
      <title>Spotify</title>
      <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.901 17.541c-.228.36-.66.48-1.021.252-2.844-1.743-6.388-2.134-10.448-1.158-.408.096-.816-.12-.912-.528-.096-.408.12-.816.528-.912 4.368-1.044 8.191-.606 11.316 1.308.36.228.48.66.252 1.021zm1.026-2.33c-.276.444-.816.576-1.26.3-3.216-1.98-8.04-2.556-11.824-1.38a.793.793 0 01-.888-.708.793.793 0 01.708-.888c4.272-1.296 9.588-.66 13.116 1.644.444.276.576.816.3 1.26zm.114-2.436C14.59 9.628 9.524 9.42 5.568 10.588a1 1 0 01-1.092-.996 1 1 0 01.996-1.092c4.488-1.26 10.116-1.02 14.688 1.908.516.324.672.996.348 1.512-.324.516-.996.672-1.512.348z"/>
    </svg>
  </button>
  <button id="btnSoundCloud" aria-label="Mở trình phát SoundCloud" class="circle-btn bg-orange-500 hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:ring-opacity-75">
    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true">
      <title>SoundCloud</title>
      <path d="M7 17.9981V6.99805C7 6.72191 6.77614 6.49805 6.5 6.49805C6.22386 6.49805 6 6.72191 6 6.99805V17.9981C6 18.2742 6.22386 18.4981 6.5 18.4981C6.77614 18.4981 7 18.2742 7 17.9981Z"/><path d="M10 17.9981V10.9981C10 10.7219 9.77614 10.4981 9.5 10.4981C9.22386 10.4981 9 10.7219 9 10.9981V17.9981C9 18.2742 9.22386 18.4981 9.5 18.4981C9.77614 18.4981 10 18.2742 10 17.9981Z"/><path d="M4 14.9981V12.9981C4 12.7219 3.77614 12.4981 3.5 12.4981C3.22386 12.4981 3 12.7219 3 12.9981V14.9981C3 15.2742 3.22386 15.4981 3.5 15.4981C3.77614 15.4981 4 15.2742 4 14.9981Z"/><path d="M13 17.9981V4.99805C13 4.72191 12.7761 4.49805 12.5 4.49805C12.2239 4.49805 12 4.72191 12 4.99805V17.9981C12 18.2742 12.2239 18.4981 12.5 18.4981C12.7761 18.4981 13 18.2742 13 17.9981Z"/><path d="M16 17.9981V9.99805C16 9.72191 15.7761 9.49805 15.5 9.49805C15.2239 9.49805 15 9.72191 15 9.99805V17.9981C15 18.2742 15.2239 18.4981 15.5 18.4981C15.7761 18.4981 16 18.2742 16 17.9981Z"/><path d="M19 17.9981V13.9981C19 13.7219 18.7761 13.4981 18.5 13.4981C18.2239 13.4981 18 13.7219 18 13.9981V17.9981C18 18.2742 18.2239 18.4981 18.5 18.4981C18.7761 18.4981 19 18.2742 19 17.9981Z"/><path d="M22 17.9981V11.9981C22 11.7219 21.7761 11.4981 21.5 11.4981C21.2239 11.4981 21 11.7219 21 11.9981V17.9981C21 18.2742 21.2239 18.4981 21.5 18.4981C21.7761 18.4981 22 18.2742 22 17.9981Z"/>
    </svg>
  </button>
</div>

<div id="popupSpotify" class="popup bg-black text-white">
  <div class="popup-header">
    <span class="title text-green-500">Spotify Player</span>
    <button class="close-popup-btn" data-popup="popupSpotify" aria-label="Đóng Spotify Player" title="Đóng">×</button>
  </div>
  <div class="popup-content">
    <iframe id="spotifyPlayer" 
            src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" 
            title="Spotify Embed Player"
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
            loading="lazy"></iframe>
    </div>
</div>


<div id="popupSoundCloud" class="popup bg-white text-black">
  <div class="popup-header">
    <span class="title text-orange-500">SoundCloud Player</span>
    <button class="close-popup-btn" data-popup="popupSoundCloud" aria-label="Đóng SoundCloud Player" title="Đóng">×</button>
  </div>
  <div class="popup-content">
    <iframe class="soundcloud-iframe"
            scrolling="no"
            allow="autoplay"
            title="SoundCloud Embed Player"
            src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/2012988732&color=%23ff5500&auto_play=false&hide_related=false&show_comments=false&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
            </div>
  <div class="soundcloud-attribution">
    <a href="https://soundcloud.com/luonghiii" target="_blank" rel="noopener noreferrer">✪ Xiang Ye ✪</a> · 
    <a href="https://soundcloud.com/luonghiii/sets/up-nhe" target="_blank" rel="noopener noreferrer">Bản quyền thuộc về Luonghii:3</a>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const btnSpotify = document.getElementById('btnSpotify');
  const btnSoundCloud = document.getElementById('btnSoundCloud');
  const popupSpotify = document.getElementById('popupSpotify');
  const popupSoundCloud = document.getElementById('popupSoundCloud');
  const closeButtons = document.querySelectorAll('.close-popup-btn'); // Changed selector
  const spotifyPlayerIframe = document.getElementById('spotifyPlayer');
  const soundcloudPlayerIframe = document.querySelector('#popupSoundCloud .soundcloud-iframe');
  
  // Store original src to stop player
  const originalSpotifySrc = spotifyPlayerIframe.src;
  const originalSoundCloudSrc = soundcloudPlayerIframe.src;

  let activePopup = null;

  function closeAllPopups(pausePlayers = true) {
    if (popupSpotify) popupSpotify.classList.remove('active');
    if (popupSoundCloud) popupSoundCloud.classList.remove('active');
    
    if (pausePlayers) {
        // Stop Spotify by resetting src (or use Spotify API if available and more complex control is needed)
        if (spotifyPlayerIframe) spotifyPlayerIframe.src = originalSpotifySrc; 
        
        // Stop SoundCloud by resetting src (or use SoundCloud Widget API)
        if (soundcloudPlayerIframe) soundcloudPlayerIframe.src = originalSoundCloudSrc;
    }
    activePopup = null;
  }

  function openPopup(popupToOpen, playerIframe) {
    if (activePopup === popupToOpen) { // If clicking the same button, toggle (close it)
        closeAllPopups();
        return;
    }
    closeAllPopups(); // Close any other open popup first
    if (popupToOpen) {
        popupToOpen.classList.add('active');
        // Optionally, auto-play when opening, though browser policies might prevent this
        // For SoundCloud, auto_play=true in src might work if not blocked.
        // For Spotify, autoplay is tricky with iframe embeds without SDK.
        activePopup = popupToOpen;
    }
  }

  if (btnSpotify && popupSpotify) {
    btnSpotify.addEventListener('click', function(e) {
      e.stopPropagation(); // Prevent click from bubbling to document
      openPopup(popupSpotify, spotifyPlayerIframe);
    });
  }

  if (btnSoundCloud && popupSoundCloud) {
    btnSoundCloud.addEventListener('click', function(e) {
      e.stopPropagation();
      openPopup(popupSoundCloud, soundcloudPlayerIframe);
    });
  }

  closeButtons.forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      closeAllPopups(); // Close and stop players
    });
  });

  // Close popup if clicked outside
  document.addEventListener('click', function (e) {
    let clickedInsidePopup = false;
    if (popupSpotify && popupSpotify.classList.contains('active') && popupSpotify.contains(e.target)) {
        clickedInsidePopup = true;
    }
    if (popupSoundCloud && popupSoundCloud.classList.contains('active') && popupSoundCloud.contains(e.target)) {
        clickedInsidePopup = true;
    }
    
    // Also check if the click was on one of the toggle buttons
    let clickedOnToggleButton = false;
    if (btnSpotify && btnSpotify.contains(e.target)) clickedOnToggleButton = true;
    if (btnSoundCloud && btnSoundCloud.contains(e.target)) clickedOnToggleButton = true;

    if (!clickedInsidePopup && !clickedOnToggleButton) {
      closeAllPopups();
    }
  });

  // Favicon animation
  const favicons = [
    'images/logo/logo1.png', 'images/logo/logo2.png', 'images/logo/logo3.png',
    'images/logo/logo4.png', 'images/logo/logo5.png'
  ];
  let currentFaviconIndex = 0; // Renamed from 'current' to avoid conflict
  const dynamicFavicon = document.getElementById('dynamic-favicon');
  if (dynamicFavicon) {
    setInterval(() => {
      dynamicFavicon.setAttribute('href', favicons[currentFaviconIndex]);
      currentFaviconIndex = (currentFaviconIndex + 1) % favicons.length;
    }, 1000); // Changed interval to 1000ms (1 second)
  } else {
      console.warn("Favicon element with id 'dynamic-favicon' not found.");
  }

});
</script>
</body>
</html>
